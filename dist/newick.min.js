"use strict";!function(){function a(b){var e=this,h=c(b);e.getRoot=function(){return d(h)},e.dfs=function(a){return h=f(h,a)},e.map=function(a){h=g(h,a)},e.normalize=function(){h=i(h)},e.serialize=function(){return j(h)},e.toString=function(){return e.serialize()},e.clone=function(){return new a(h)}}function c(b){if("string"==typeof b)try{b=JSON.parse(b)}catch(c){b=a.parse(b)}return b}function e(a){a=c(a);for(var b in a)if(a.hasOwnProperty(b)&&"name"==b)return a[b]}function k(a){var b="";return a.branchset&&a.branchset.length&&(b+="("+a.branchset.map(k).join(",")+")"),null!=a.name&&(b+=a.name),null!=a.length&&(b+=":"+a.length),b}var b=function(a){for(var b=[],c={},d=a.split(/\s*(;|\(|\)|,|:)\s*/),e=0;e<d.length;e++){var f=d[e];switch(f){case"(":var g={};c.branchset=[g],b.push(c),c=g;break;case",":var g={};b[b.length-1].branchset.push(g),c=g;break;case")":c=b.pop();break;case":":break;default:var h=d[e-1];")"==h||"("==h||","==h?c.name=f:":"==h&&(c.length=parseFloat(f))}}return c};a.parse=b;var d=function(a){return e(a)};a.getRoot=d;var f=function(a,b){function e(a){var c=a.branchset||[];if(0!==c.length)for(var f=0;f<c.length;f++)d[c[f].name]=c[f].length,a.branchset[f]=b(a.branchset[f]),e(c[f])}b=b||function(a){return a};var d={};return a=c(a),e(a),d};a.dfs=f;var g=function(b,d){return d=d||function(a){return a},b=c(b),a.dfs(b,null,d),b};a.map=g;var h=function(a){function b(a){var c=a.branchset||[];if(a.hasOwnProperty("length")){for(var d=0,e=0;e<c.length;e++)d+=c[e].length;for(var f=a.length/d,e=0;e<c.length;e++)c[e].length+=c[e].length*f;0!=c.length&&(a.length=0),console.log(a)}for(var e=0;e<c.length;e++)b(c[e])}return a=c(a),b(a),a};a.drown=h;var i=function(b){function d(b){var c=a.dfs(b),d=0;for(var e in c)c.hasOwnProperty(e)&&(d+=c[e]);return a.dfs(b,null,function(a){return a.length=a.length/d,a}),b}return b=c(b),d(b)};a.normalize=i;var j=function(a){return a=c(a),k(a)+";"};a.serialize=j,"undefined"!=typeof window?window.Newick=a:module.exports=a}();