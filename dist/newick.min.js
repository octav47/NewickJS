"use strict";!function(n){function r(n){if("string"==typeof n)try{n=JSON.parse(n)}catch(r){n=Newick.parse(n)}return n}function t(n){n=r(n);for(var t in n)if(n.hasOwnProperty(t)&&"name"==t)return n[t]}function e(n){var r="";return n.branchset&&n.branchset.length&&(r+="("+n.branchset.map(e).join(",")+")"),null!=n.name&&(r+=n.name),null!=n.length&&(r+=":"+n.length),r}n.parse=function(n){for(var r=[],t={},e=n.split(/\s*(;|\(|\)|,|:)\s*/),a=0;a<e.length;a++){var o=e[a];switch(o){case"(":var u={};t.branchset=[u],r.push(t),t=u;break;case",":var u={};r[r.length-1].branchset.push(u),t=u;break;case")":t=r.pop();break;case":":break;default:var h=e[a-1];")"==h||"("==h||","==h?t.name=o:":"==h&&(t.length=parseFloat(o))}}return t},n.getRoot=function(n){return t(n)},n.dfs=function(n,t){function e(n){var r=n.branchset||[];if(0!==r.length)for(var o=0;o<r.length;o++)a[r[o].name]=r[o].length,n.branchset[o]=t(n.branchset[o]),e(r[o])}t=t||function(n){return n};var a={};return n=r(n),e(n),a},n.map=function(t,e){return e=e||function(n){return n},t=r(t),n.dfs(t,null,e),t},n.drown=function(n){function t(n){var r=n.branchset||[];if(n.hasOwnProperty("length")){for(var e=0,a=0;a<r.length;a++)e+=r[a].length;for(var o=n.length/e,a=0;a<r.length;a++)r[a].length+=r[a].length*o;0!=r.length&&(n.length=0),console.log(n)}for(var a=0;a<r.length;a++)t(r[a])}return n=r(n),t(n),n},n.normalize=function(t){function e(r){var t=n.dfs(r),e=0;for(var a in t)t.hasOwnProperty(a)&&(e+=t[a]);return n.dfs(r,null,function(n){return n.length=n.length/e,n}),r}return t=r(t),e(t)},n.serialize=function(n){return n=r(n),e(n)+";"}}("undefined"!=typeof exports?exports:this.Newick={});